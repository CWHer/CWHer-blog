---
title: 拉格朗日插值
date: 2018-07-26 20:36:41
tags: [组合数学,模板]
categories: [OI]
password:
top: 0
mathjax: true
---
~~证明省略~~
$$
f\left (x  \right )=\sum_{i=1}^{n+1}y_i\prod_{j\neq i}\frac{\left ( x-x_{j} \right )}{\left (x_{i}-x_{j}  \right )}
$$
<!--more-->

```c++
#include<cstdio>
#define LL long long
const int mod=998244353;
const int N=2050;
LL n,x,a[N],b[N],ans=0;
inline int read()
{
    register int x=0,t=1;
    register char ch=getchar();
    while (ch!='-'&&(ch<'0'||ch>'9')) ch=getchar();
    if (ch=='-') t=-1,ch=getchar();
    while (ch>='0'&&ch<='9') x=x*10+ch-48,ch=getchar();
    return x*t;
}
LL pow(LL a,LL b,LL mod)
{
    LL ret=1;
    for(;b;b>>=1)
    {
        if (b&1) ret=ret*a%mod;
        a=a*a%mod; 
    }
    return ret;
}
int main()
{
    n=read(),x=read();
    for(int i=1;i<=n;i++) a[i]=read(),b[i]=read();
    for(int i=1;i<=n;i++)
    {
        LL A=b[i],B=1;
        for(int j=1;j<=n;j++) if (i!=j)
        {
            A=A*(x-a[j])%mod;
            B=B*(a[i]-a[j])%mod;
        }
        ans=(ans+A*pow(B,mod-2,mod))%mod;
    }
    printf("%lld\n",(ans%mod+mod)%mod);
    return 0;
}
```

